{"version":3,"file":"commonHelpers.js","sources":["../src/js/search-api.js","../src/js/index.js"],"sourcesContent":["import axios from 'axios';\n\nconst searchQuery = { value: '' };\nconst page = { value: 1 };\nconst perPage = 40;\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\naxios.defaults.params = {\n  key: '22046149-41a2515b5a783e6a5f4bfbfcc',\n  per_page: perPage,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n};\n\nasync function fetchGallery(searchQuery) {\n  try {\n    const response = await axios.get('/', {\n      params: {\n        ...axios.defaults.params,\n        q: searchQuery,\n        page: page.value,\n      },\n    });\n\n    return response.data;\n  } catch (error) {\n    throw new Error('An error occurred while fetching images.');\n  }\n}\n\nexport { fetchGallery, page, perPage, searchQuery };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchGallery, page, perPage, searchQuery } from './search-api';\n\nconst form = document.getElementById('search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nconst lightbox = new SimpleLightbox('.gallery a');\n\nform.addEventListener('submit', handleFormSubmit);\nloadMoreBtn.addEventListener('click', loadMoreImages);\n\nlet totalHits = 0;\n\nasync function handleFormSubmit(evt) {\n  evt.preventDefault();\n  hideLoadMoreBtn();\n\n  page.value = 1;\n  totalHits = 0;\n  const query = evt.currentTarget.elements.searchQuery.value.trim();\n  searchQuery.value = query;\n\n  if (searchQuery.value === '') {\n    showError('â‰ï¸ Please enter your search query.');\n    return;\n  }\n\n  clearGallery();\n  await searchImages();\n  showLoadMoreBtn();\n}\n\nasync function searchImages() {\n  try {\n    const data = await fetchGallery(searchQuery.value);\n\n    if (data.hits.length === 0) {\n      showNoResults();\n      return;\n    }\n\n    totalHits = data.totalHits;\n    renderGallery(data.hits);\n\n    if (totalHits > 0 && page.value === 1) {\n      showSuccessMessage();\n    }\n  } catch (error) {\n    showError(error.message);\n  }\n}\n\nfunction loadMoreImages() {\n  page.value += 1;\n  searchImages();\n\n  // Smooth scroll up two cards height\n  setTimeout(() => {\n    const { height: cardHeight } = document\n      .querySelector('.gallery')\n      .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }, 500);\n}\n\nfunction renderGallery(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        likes,\n        views,\n        comments,\n        downloads,\n        largeImageURL,\n        tags,\n      }) => `\n      <a class=\"card-item\" href=\"${largeImageURL}\" data-lightbox=\"gallery-item\" aria-role=\"button\" >\n      <div class=\"card-box\">\n            <img src=\"${webformatURL}\" class=\"card-img\" alt=\"${tags}\" loading=\"lazy\" />\n            </div>\n            <div class=\"info\">\n            <p class=\"info-item\">\n            <b>likes</b> ${likes}</p>\n            <p class=\"info-item\">\n            <b>views</b> ${views}</p>\n            <p class=\"info-item\">\n            <b>comments</b> ${comments}</p>\n            <p class=\"info-item\"><b>downloads</b> ${downloads}</p>\n            </div>\n            </a>`\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n\n  const totalDisplayed = page.value * perPage;\n\n  if (totalHits <= totalDisplayed) {\n    hideLoadMoreBtn();\n    showEndMessage();\n  }\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = '';\n}\n\nfunction showLoadMoreBtn() {\n  const totalDisplayed = page.value * perPage;\n  const isLastPage = totalHits <= totalDisplayed;\n\n  loadMoreBtn.style.display = isLastPage ? 'none' : 'block';\n  showSuccessMessage.enabled = !isLastPage;\n\n  if (!isLastPage) {\n    lightbox.refresh();\n  }\n}\n\nfunction hideLoadMoreBtn() {\n  loadMoreBtn.style.display = 'none';\n}\n\nfunction showError(message) {\n  iziToast.error({\n    message: message,\n  });\n}\n\nfunction showSuccessMessage() {\n  iziToast.success({\n    message: `ðŸŽ‰ Hooray! We found ${totalHits} images.`,\n  });\n}\n\nfunction showNoResults() {\n  iziToast.warning({\n    message: `ðŸ§ Sorry, there are no images matching your search query. Please try again.`,\n  });\n}\n\nfunction showEndMessage() {\n  setTimeout(() => {\n    iziToast.info({\n      message: `We're sorry, but you've reached the end of ${totalHits} search results.`,\n      position: 'bottomCenter',\n      timeout: 4000,\n    });\n  }, 4000);\n}\n\niziToast.settings({\n  messageColor: 'rgb(22, 24, 61)',\n  position: 'topRight',\n  timeout: 2500,\n  closeOnEscape: true,\n  animateInside: true,\n  drag: true,\n  pauseOnHover: true,\n  progressBarEasing: 'linear',\n  overlay: false,\n  overlayClose: false,\n  overlayColor: 'rgba(0, 0, 0, 0.6)',\n  icon: 'material-icons',\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n});\n\nconsole.log(fetchGallery());\n"],"names":["searchQuery","page","perPage","axios","fetchGallery","form","gallery","loadMoreBtn","lightbox","SimpleLightbox","handleFormSubmit","loadMoreImages","totalHits","evt","hideLoadMoreBtn","query","showError","clearGallery","searchImages","showLoadMoreBtn","data","showNoResults","renderGallery","showSuccessMessage","error","cardHeight","images","markup","webformatURL","likes","views","comments","downloads","largeImageURL","tags","totalDisplayed","showEndMessage","isLastPage","message","iziToast"],"mappings":"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"}